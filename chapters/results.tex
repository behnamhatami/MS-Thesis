
\فصل{نتایج جدید}

در این فصل نتایج جدید به‌دست‌آمده در پایان‌نامه توضیح داده می‌شود. این فصل در سه بخش تهیه شده است. بخش اول به بیان مقدمات و نمادگذاری‌های مورد نیاز برای بخش‌های بعدی می‌پردازد. در بخش دوم، راه‌حل‌های ارائه‌شده برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت در حالت جویبار داده مورد بررسی قرار می‌گیرد. این بخش به سه زیربخش تقسیم می‌شود. 

در زیربخش اول، دو الگوریتم جدید ارائه می‌شود. الگوریتم اول، با مصرف حافظه‌ی $\cO(z^2d)$، جوابی با ضریب تقریب $2$ ارائه می‌دهد که حافظه‌ی مصرفی الگوریتم ضرابی‌زاده و سایرین \مرجع{zarrabi2009streaming} را در صورتی که ابعاد فضا بیش‌تر از $z$ باشد بهبود می‌بخشد. از طرفی الگوریتم ارائه شده بسیار ساده‌تر از الگوریتم ضرابی‌زاده است. الگوریتم دوم یک الگوریتم با ضریب تقریب $1.8 + \epsilon$ و حافظه‌ی مصرفی $\cO(\frac{z^2}{\epsilon})$ است.

در زیر بخش دوم، به بررسی مسئله‌ی $1$-مرکز پوشاننده بدون داده‌ی پرت می‌پردازیم، به‌طوری‌که نه تنها می‌خواهیم تمام نقاط ورودی پوشیده شود، بلکه می‌خواهیم کل توپ بهینه نیز به طور کامل پوشیده شود. برای این مسئله، یک الگوریتم با ضریب تقریب $1.7$ ارائه می‌شود. در زیربخش سوم، با استفاده از زیربخش‌های قبلی، الگوریتمی با ضریب تقریب $1.7$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت ارائه می‌دهیم(برای حالتی که $z$ ثابت است). 

در بخش سوم، مسئله‌ی $2$-مرکز با $z$-داده‌ی پرت مورد بررسی قرار می‌گیرد. ایده‌ی اصلی این بخش، تقسیم‌بندی مسئله به دو حالت است که حاصل، دو الگوریتم متفاوت می‌شود که به صورت موازی اجرا می‌شوند. هر دوی این الگوریم‌ها ضریب تقریب $1.8 + \epsilon$ دارند و حافظه‌ی مصرفی در کل برابر است با 
$\cO(dz^2 (d^2 + \frac{z}{\epsilon}))$.
این اولین الگوریتم ارائه‌شده‌ بعد از الگوریتمی که با ضریب تقریب $4+\epsilon$ برای $k$ کلی ارائه شده است، می‌باشد که بهبود قابل توجهی محسوب می‌شود.

\قسمت{نماد‌گذاری‌ها و تعاریف اولیه}

در این قسمت، تعدادی نمادگذاری که در بخش‌های آتی مورد استفاده قرار می‌گیرند، بیان می‌شود. علاوه بر این، تعدادی از مفاهیم و تعاریف رایج که در بخش‌های آتی به تکرار مورد استفاده قرار می‌گیرند نیز در این فصل مورد بررسی قرار می‌گیرد.


\شروع{شکل}[ht]
\centerimg{delta-definition}{10cm}
\شرح{تعریف فاصله‌ی دو توپ دلخواه}
\برچسب{شکل:دلتا}
\پایان{شکل}


\شروع{فقرات}

\فقره{در طول متن، برای مشخص کردن یک توپ از نماد $B(c, r)$ استفاده می‌کنیم که $c$ مرکز توپ و $r$ شعاع آن را مشخص می‌کند. هر جا خواستیم به شعاع توپی ارجاع دهیم از نماد $r(B)$ و هر گاه خواستیم به مرکز یک توپ اشاره کنیم از نماد $c(B)$ استفاده می‌کنیم.} 
\فقره{به ازای هر دو نقطه‌ی دلخواه $p$ و $q$ در فضا، فاصله‌ی $p$ و $q$ را با $\len{pq}$ نشان می‌دهیم.}
\فقره{همان‌طور که در شکل ~\رجوع{شکل:دلتا} نشان داده شده است، دو توپ دلخواه $B(c, r)$ و $B'(c', r')$ را در نظر بگیرید. فاصله‌ی دو توپ $B$ و $B'$ مطابق‌ زیر تعریف می‌شود:
$$\delta(B, B') = \max \{ 0, \len{cc'} - r - r'\}$$
}
\فقره{دو توپ دلخواه $B(c, r)$ و $B'(c', r')$ را $\alpha$-تفکیک‌شده گوییم اگر داشته باشیم:
$$\delta(B, B') \geq \alpha . \max \{ r(B), r(B') \}$$
 }
 
 \فقره{زمانی که می‌خواهیم در مورد توپ بهینه‌ی $1$-مرکز صحبت کنیم از $B^*(c^*, r^*)$ یا $MEB(c^*, r^*)$ استفاده می‌کنیم. برای مسئله‌ی $2$-مرکز نیز از $B_1^*(c_1^*, r^*)$ و $B_2^*(c_2^*, r^*)$ برای نشان دادن دو دایره‌ی بهینه‌ مسئله‌ی $2$-مرکز برای مجموعه‌ای از نقاط استفاده می‌کنیم.}
 
 \فقره{مجموعه‌ نقاط‌ $P$ داده شده است. $k$-دورترین نقطه از $p \in P$ نقطه‌ای از $P$ است که فاصله‌اش از نقطه‌ی $p$، $k$-امین بزرگ‌ترین فاصله را در بین تمام نقاط‌ $P$ داراست.}
\پایان{فقرات}

علاوه بر نمادگذاری‌های بالا, در بخش‌های بعدی، بعضی از تعاریف رایج در هندسه‌ی محاسباتی مورد استفاده قرار می‌گیرد. فرض کنید مجموعه‌ی $n$-عضوی $P$ از نقاط در $\IR^d$ داده شده است. نقطه‌ی $c \in \IR^d$ را نقطه‌ی مرکزی\پاورقی{Centerpoint} مجموعه‌ی $P$ می‌گویند، اگر هر نیم‌صفحه‌ی\پاورقی{Half Space} شامل $c$، حداقل شامل $\ceil{\frac{n}{d+1}}$ نقطه از نقاط $P$ باشد. مرجع ~\مرجع{danzer1963helly} ثابت کرده است که هر مجموعه‌ی متناهی از نقاط در فضای $d$-بعدی، دارای یک نقطه‌ی مرکزی است. مشاهده‌ی زیر نتیجه‌ی مستقیم این گزاره است.

\شروع{مشاهده}

مجموعه‌ی $P$ با $k(d+1)$ نقطه در فضای $d$-بعدی داده شده است. هر شکل محدب که شامل نقطه‌ی مرکزی $P$ نباشد، حداقل $k$ نقطه‌ از $P$ را نیز نمی‌پوشاند.

\پایان{مشاهده}

در این پایان‌نامه، فرض می‌کنیم ذخیره‌ی هر بعد از یک نقطه‌ حافظه‌ی ثابتی مصرف می‌کند. در نتیجه، ذخیره‌سازی یک نقطه در فضای $d$-بعدی، $\cO(d)$ حافظه مصرف می‌کند و عملیات عادی بر روی نقاط نیز‌ $\cO(d)$ زمان می‌برد.

\قسمت{مسئله‌ی $1$-مرکز در حالت جویبار داده}

در این بخش به بررسی گونه‌های مختلفی از مسئله‌ی $1$-مرکز در حالت جویبار داده می‌پردازیم. مباحث این بخش، به صورت سه زیربخش دسته‌بندی شده است. در زیربخش اول مسئله‌ی $1$-مرکز با داده‌های پرت، مورد بررسی قرار می‌گیرد. در زیرقسمت دوم مسئله‌ی $1$-مرکز پوشاننده مورد بررسی قرار می‌گیرد و در نهایت در بخش سوم، با استفاده از نتایج دو بخش قبلی، مسئله‌ی $1$-مرکز با تعداد ثابتی داده‌ی پرت، مورد بررسی قرار می‌گیرد. در هر سه بخش‌، الگوریتم‌های قبلی از جنبه‌ یا جنبه‌هایی بهبود داده شده‌اند. مهم‌ترین معیار‌های مطرح، ضریب تقریب و حافظه‌ی مصرفی است که در هر الگوریتم به دقت محاسبه شده‌ و با کارهای قبلی مقایسه می‌شوند.

\زیرقسمت{مسئله‌ی $1$-مرکز با داده‌های پرت در حالت جویبار داده}

در این زیربخش، دو الگوریتم کاملا متفاوت برای مسئله‌ی $1$-مرکز‌ ارائه می‌شود که نسبت به الگوریتم‌های موجود ساده‌تر هستند و حافظه‌ی مصرفی کم‌تری دارند. از طرفی دیگر، دارای ویژگی‌هایی هستند که با استفاده از آن‌ها، در فصول بعدی، الگوریتم تفریبی برای مسئله‌ی $2$-مرکز ارائه می‌شود.

\زیرزیرقسمت{الگوریتم تقریبی با ضریب تقریب $2$}

در این قسمت، یک الگوریتم ساده‌ی جویبارداده با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با داده‌ی پرت ارائه می‌شود. در این الگوریتم، از ایده‌ی موازی‌سازی\پاورقی{Parallelization} استفاده می‌شود که به وفور در بخش‌های آتی مورد استفاده قرار می‌گیرد. در الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} شبه‌کد\پاورقی{Pseudocode} الگوریتم ارائه‌شده آمده است. الگوریتم، جویبارداده‌ی $P$ و $z$ تعداد داده‌های پرت را از ورودی دریافت می‌کند. همان‌طور که می‌بینید الگوریتم فرض کرده است که نقطه‌ی اول جویبار داده، داده‌ی پرت نیست. در ادامه نشان خواهیم داد چگونه چنین فرضی را حذف نماییم. در نهایت الگوریتم توپ $B$ را بر می‌گرداند که همه‌ی نقاط $P$ به غیر از حداکثر $z$ نقطه را می‌پوشاند (دقیقا $z$ دورترین نقطه‌ از نقطه‌ی اول را نمی‌پوشاند).

\شروع{الگوریتم}{الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}
\دستور{$c$ را اولین نقطه از جویبارداده‌ی $P$ قرار بده.}
\دستور{توپ $B(c, 0)$ را در نظر بگیر.}
\دستور{حافظه‌ی میان‌گیر خالی $Q$ را در نظر بگیر.}
\به‌ازای{هر $p$ در مجموعه‌ی $P$}
\اگر{$p \not \in B$}
\دستور{$p$ را به $Q$ اضافه کن.}
\اگر{$|Q| = z + 1$}
\دستور{$q$ را نزدیک‌ترین نقطه‌ی $Q$ به مرکز $c$ در نظر بگیر.}
\دستور{$q$ را از $Q$ حذف کن.}
\دستور{$B$ را با توپ $B(c, \len{cq})$ جایگزین کن.}
\پایان‌اگر
\پایان‌اگر
\پایان‌به‌ازای{}
\دستور{$B$ را برگردان}
\پایان{الگوریتم}

\شروع{قضیه}
\برچسب{قضیه: $1$-مرکز $2$-تقریب}
الگوریتم  ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}  با فرض این‌که نقطه‌ی اول جویبار داده، داده‌ی پرت نیست یک الگوریتم تقریبی با ضریب تقریب ۲ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت است.
\شروع{اثبات}

فرض کنید $B^*(c^*, r^*)$ توپ جواب بهینه باشد و $c$ نقطه‌ی دلخواهی از جویبار داده‌ی $P$ است که در جواب بهینه قرار دارد و جزء نقاط پرت نیست. بنابراین $c$ داخل $B^*$ قرار دارد. به ازای هر نقطه‌ی دلخواه $p \in B^*$ داریم:
$$\len{cp} \leq \len{cc^*} + \len{c^*p} \leq 2r^*$$
از طرفی، از بین $z+1$ دورترین نقطه از $c$، حداقل یک نقطه به نام $q$ وجود دارد که در جواب بهینه داده‌ی پرت نیست و در نتیجه داخل $B^*$ قرار دارد (به شکل ~\رجوع{شکل: $1$-مرکز $2$-تقریب} نگاه کنید). با توجه به گزاره‌ی گفته‌شده، $\len{cq} \leq 2r^*$ است. از طرفی چون شعاع جواب الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} به اندازه‌ی فاصله‌ی $c$ از‌ $z+1$-دورترین نقطه‌ از $c$ است، بنابراین شعاع جواب الگوریتم نیز کم‌تر مساوی $2r^*$ است و بنابراین الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} یک الگوریتم $2$-تقریب برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت است.

\پایان{اثبات}

\پایان{قضیه}


\شروع{شکل}[ht]
\centerimg{2-approx-1-center}{10cm}
\شرح{اثبات قضیه‌ی ~\رجوع{قضیه: $1$-مرکز $2$-تقریب}}
\برچسب{شکل: $1$-مرکز $2$-تقریب}
\پایان{شکل}

الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} به طور ضمنی فرض کرده است که نقطه‌ی اول، در جواب بهینه نقطه‌ی پرت نیست. برای حذف چنین فرضی، $z+1$ نمونه از الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} به طور موازی اجرا می‌گردد به‌طوری‌که در هر کدام، یکی از $z+1$ نقطه‌ی اول به آن به عنوان نقطه‌ی اول جویبار داده به الگوریتم داده می‌شود و بقیه نقاط در ادامه می‌آید. به وضوح، در بین $z+1$ نقطه‌ی اول، حتما یک نقطه‌ وجود دارد که در جواب بهینه داده‌ی پرت نیست. بنابراین جواب آن نمونه از الگوریتم، یک $2$-تقریب برای جوابه بهینه است و در نتیجه، کوچک‌ترین توپ بین $z+1$ نمونه‌ی موازی، همواره یک $2$-تقریب برای جواب بهینه است. با توجه به این‌که پیچیدگی حافظه‌ی الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} برای یک نمونه از مرتبه‌ی $\cO(zd)$ است و زمان به‌روزرسانی‌ آن از مرتبه‌ی $\cO(d + \log{z})$ است، نتیجه زیر به دست می‌آید. 

\شروع{قضیه}
برای یک جویبار‌داده از نقاط در فضای $d$-بعدی، الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} یک $2$-تقریب برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت با حافظه‌ی مصرفی $\cO(z^2d)$ و زمان به‌روزرسانی $\cO(zd + z\log{z})$ ارائه می‌دهد.
\پایان{قضیه}


\زیرزیرقسمت{الگوریتم تقریبی با ضریب تقریب $1.8$}

در این قسمت، الگوریتمی با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت ارائه می‌دهیم. برای بیان الگوریتم فرض می‌کنیم $r'$ای داده شده است که در شرایط زیر صدق می‌کند:
$$1.2r^* \leq r' \leq (1.2 + \frac{2\epsilon}{3})r^*$$
با فرض داده شدن $r'$، الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}، یک توپ با شعاع حداکثر $\frac{3}{2}r'$ ارائه می‌دهد که حداکثر $z$ نقطه از جویبارداده را نمی‌پوشاند. بدون کم شدن از کلیت مسئله، همانند قسمت قبلی فرض کنید که نقطه‌ی اول جویبار داده، جزء نقاط پرت در جواب بهینه نباشد. در نهایت برای حذف چنین فرضی کافی است $z+1$ نمونه از الگوریتم ارائه شده را به طور موازی اجرا نموده و از بین $z+1$ توپ جواب، توپ با کوچک‌ترین شعاع را به عنوان جواب نهایی بدهیم. با این تغییر، حافظه‌ی مصرفی، زمان به‌روزرسانی و زمان پاسخ‌گویی به پرسمان همگی در مرتبه‌ی $\cO(z)$ ضرب می‌شوند. برای ادامه‌ی کار به لم زیر نیاز داریم:

\شروع{شکل}[ht]
\centerimg{18-approx-1-center}{10cm}
\شرح{گسترش توپ $B(c, r')$ در راستای نقطه‌ی $q$}
\برچسب{شکل: $1.8$-تقریب $1$-مرکز}
\پایان{شکل}


\شروع{لم}

همان‌طور که در شکل ~\رجوع{شکل: $1.8$-تقریب $1$-مرکز} نشان داده شده است، نقطه‌ی $q$ از جویبارداده‌ی $P$ را در نظر بگیرید به‌طوری‌که در توپ بهینه‌ی $B^*$  قرار گرفته (داده‌ی پرت نیست) و فاصله‌ی آن از $p_1$ بزرگ‌تر مساوی $r'$ باشد. نقطه‌ی $c$ را در فاصله‌ی $\frac{1}{2}r'$ از $p_1$ برروی پاره‌خط $p_1q$ در نظر بگیرید. ثابت می‌شود توپ $B'(c, \frac{3r'}{2})$، توپ $B^*$ و $B(p_1, r')$ را به طور کامل می‌پوشاند (توپ $B^*$ و $B(p_1, r')$ به طور کامل داخل $B'$ قرار می‌گیرند). به چنین عملی گسترش توپ $B(p_1, r')$ در راستای نقطه‌ی $q$ گفته می‌شود.

\شروع{اثبات}

طبق لم ~\رجوع{لم:ahn-segment2}، مرکز‌ توپ $B^*$ که با $c^*$ نشان داده می‌شود، حداکثر $0.8r^*$ از $q$ فاصله دارد. برای هر نقطه‌ی $s$ که در توپ $B(c, r')$ قرار می‌گیرد، داریم:
$$\len{sc} \leq \len{sp_1}  + \len{p_1c} \leq r' + \frac{1}{2}r' \leq \frac{3r'}{2}$$
از طرفی برای هر نقطه‌ی $s$ داخل $B^*$  داریم:
$$\len{sc} \leq \len{sc^*}  + \len{c^*c} \leq r^* + 0.8r^* \leq \frac{3r'}{2}$$
و در نتیجه هر نقطه از $B^*$ داخل $B(c, \frac{3r'}{2})$ قرار می‌گیرد و بنابراین $B(c, \frac{3r'}{2})$ به طور کامل $B^*$ را می‌پوشاند. 

\پایان{اثبات}

\پایان{لم}

در واقع به عنوان نتیجه مستقیم لم بالا، اگر بتوانیم دو نقطه‌ی غیر پرت با فاصله‌ی بیش‌تر مساوی $r'$ پیدا کنیم، می‌توانیم یک توپ به شعاع $\frac{3}{2}r'$ ارائه دهیم که توپ $B^*$ را به طور کامل می‌پوشاند.

\شروع{الگوریتم}{الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}
\دستور{فرض کنید $r'$ تقریب برای $1.2r^*$ و $z_0$ تعداد نقاط پرت قبل ار گسترش $B$ داده شده‌اند.}
\دستور{توپ $B(p_1, r')$ را در نظر بگیر.}
\دستور{حافظه‌ی میان‌گیر خالی $Q$ را در نظر بگیر.}
\به‌ازای{هر $p$ در مجموعه‌ی $P$}
\اگر{$p \not \in B$}
\دستور{$p$ را به $Q$ اضافه کن.}
\اگر{$B$ هنوز‌ گسترش‌ پیدا نکرده و $|Q| = z_0 + 1$}
\دستور{توپ $B$ را در راستای $p$ گسترش‌ بده.}
\به‌ازای{هر $q \in Q$}
\اگر{$q \in B$}
\دستور{$q$ را از $Q$ حذف کن.}
\پایان‌اگر{}
\پایان‌به‌ازای{}
\پایان‌اگر
\اگر{$Q = z+1$}
\دستور{از برنامه خارج شو.}
\پایان‌اگر{}
\پایان‌اگر{}
\پایان‌به‌ازای{}
\دستور{$B$ را برگردان}
\پایان{الگوریتم}

با توجه به لم بالا، با فرض داشتن $r'$، همان‌طور که در الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} می‌بینید، در ابتدا توپ $B(p_1, r')$ را به عنوان توپ کاندید در نظر می‌گیریم. حال نقاطی که خارج این توپ قرار می‌گیرند را داخل یک حافظه‌ی میان‌گیر قرار می‌دهیم. اگر اندازه حافظه‌ی میان‌گیر هیچ‌گاه به $z+1$ نرسید، بنابراین توپی با شعاع $r'$ پیدا کرده‌ایم که حداکثر $z$ نقطه خارج آن قرار دارد و چون  $1.2r^* \leq r' \leq (1.2 + \frac{2\epsilon}{3})r^*$ است، بنابراین یک جواب با ضریب تقریب $1.2 + \epsilon$ از جواب بهینه به دست آورده‌ایم. اگر حافظه‌ی میان‌گیر پر شود، حتما یکی از اعضای آن وجود دارد که جزء داده‌های پرت نبوده (طبق‌ اصل لانه‌کبوتری\پاورقی{Pigeonhole Principle}). بنابراین اگر نسبت به آن نقطه‌(کافی است تمام گزینه‌ها را امتحان کنیم) توپ اولیه را گسترش دهیم، به توپی می‌رسیم که تمام نقاط قبلی (غیر از نقاط داخل حافظه‌ی میان‌گیر) را پوشانده و مطمئن هستیم کل جواب بهینه را نیز می‌پوشاند. 

پس از گسترش هر کدام از  گزینه‌ها، کافی است در هر لحظه نگه‌داریم چند نقطه و کدام نقاط خارج از توپ گسترش‌‌یافته قرار می‌گیرند. توجه کنید در لحظه‌ی تشکیل توپ گسترش‌یافته، طبق لم بالا، تنها نقاط حافظه‌ی میان‌گیر که تعدادشان $z$ تاست ($z+1$ نقطه‌ی حافظه‌ی میان‌گیر به غیر از نقطه‌ای که در آن راستا توپ را گسترش داده‌ایم)، ممکن است خارج توپ گسترش‌یافته قرار بگیرند و نیازی به نگه‌داشتن نقاط قبلی نیست. اگر در ادامه‌ی جویبارداده تعداد نقاط خارج از توپ گسترش‌یافته بیش از $z$ عدد گردد، با پوشش‌ کامل $B^*$ تناقض دارد و در نتیجه با توجه به لم بالا، یا نقطه‌ی $q$ خود جزء داده‌های پرت در جواب بهینه بوده است یا شعاع $r'$ در شرایط‌ گفته شده صدق نمی‌کرده است و در هر صورت گزینه باید حذف گردد. با این حذف گزینه‌ها، در هر لحظه تعدادی گزینه داریم(همواره حداقل یک گزینه وجود دارد، چون حالتی وجود دارد که فرض برای آن درست است) و هر کدام یک جواب با شعاع حداکثر $\frac{3}{2}r'$ ارائه می‌دهند که اگر از بین آن‌ها توپ با شعار کمینه را به عنوان جواب نهایی بدهیم، مطمئنا یک جواب با تقریب حداکثر $1.8 + \epsilon$ از جواب بهینه ارائه داده‌ایم.

تا به این‌جا الگوریتمی ارائه دادیم که با فرض داشتن $r'$ و داده‌ی پرت نبودن $p_1$، با مصرف حافظه‌ی $\cO(z)$ و زمان به‌روزرسانی $\cO(z)$ در هر لحظه‌ می‌تواند یک $1.8 + \epsilon$-تقریب از جواب بهینه بدهد.

تنها قسمتی که مورد بررسی قرار نگرفته است، نحوه‌ی به‌دست‌آوردن $r'$ است که در این قسمت به بررسی آن خواهیم پرداخت. در ابتدا برای این‌که ایده‌ی اصلی را درک کنیم فرض کنید که می‌خواهیم یک الگوریتم دو گذره برای این مسئله ارائه دهیم، به‌طوری‌که در گذر اول، $r'$ محاسبه می‌شود و در گذر دوم، با استفاده از‌ $r'$ به‌دست‌آمده و الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}، یک $1.8 + \epsilon$ تقریب ارائه می‌گردد. در ادامه نشان داده می‌شود، چگونه می‌توان این دو گذر را هم‌زمان اجرا نمود. برای پیدا کردن $r'$ کافی است که با استفاده از یک الگوریتم $\alpha$-تقریب (به طور مثال الگوریتم $2$-تقریب ارائه شده در قسمت قبلی)، یک $r$ به‌دست آوریم. طبق الگوریتم استفاده شده داریم:
$$r^* \leq r \leq \alpha r^*$$ 
حال اگر بازه‌ی $[0, 1.2r]$ را به 
$$m = \ceil{\frac{3}{2} \times 1.2 \times \alpha \times \frac{1}{\epsilon}}$$
 قسمت مساوی تقسیم کنیم، طول هر قسمت برابر است با:
 $$\frac{1.2  r}{m} = \frac{2}{3} \times \frac{r}{\alpha} \times \epsilon \leq \frac{2\epsilon}{3}r^*$$
 از طرفی چون $1.2r^* \leq 1.2r$ است، بنابراین یکی از این بازه‌ها $1.2r^*$ را شامل می‌شود و انتهای آن بازه با توجه به طول بازه‌ها، کاندیدای مناسبی برای $r'$ است. بنابراین کافی است پس از پیدا کردن یک $\alpha$-تقریب برای مسئله‌ی $1$-مرکز‌ با $z$ داده‌ی پرت، به ازای سرهای تمام بازه‌ها، الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} را اجرا کنیم و از بین گزینه‌هایی که باقی می‌مانند کوچک‌ترین توپ را به عنوان جواب نهایی بدهیم. با توجه به این‌که برای سر یکی از بازه‌ها، $r$ در شرایط  $1.2r^* \leq r \leq (1.2 + \frac{2\epsilon}{3})r^*$  صدق می‌کند، در نتیجه یکی از گزینه‌ها یک $1.8 + \epsilon$-تقریب برای جواب بهینه است و در نتیجه توپ با شعاع کمینه نیز‌ همین ضریب تقریب را تضمین می‌کند.
 
 تنها قسمتی که نیاز به دقیق شدن دارد، قسمت تک‌گذره کردن الگوریتم است. همان‌طور که گفته شد، از الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} که الگوریتمی $2$-تقریب است، برای پیدا کردن $r'$ استفاده می‌کنیم. فرض کنید $r_i$ برابر شعاع الگوریتم $2$-تقریب برای جویبارداده تا $i$اُمین عنصر جویبار داده باشد. به وضوح دنباله‌ی $r_i$ یک دنباله صعودی است. به ازای هر $i$، $k$ را عدد صحیحی در نظر بگیرید که رابطه‌‌ی زیر برقرار باشد:
 $$2^{k-1} \leq r_i \leq 2^k$$
 با توجه به $k$ بالا $l_i = 2^k$ قرار دهید. به وضوح طبق‌ رابطه‌ی گفته شده، $l_i \leq 2r_i$ است و در نتیجه $l_i$ یک $4$-تقریب برای مسئله‌ی $1$-مرکز  با $z$ داده‌ی پرت است.
 
 حال کافی است بازه‌ی $[0, 1.2l_i]$ را به $m = \ceil{\frac{7.2}{\epsilon}}$ قسمت تقسیم کنیم. با این تقسیم‌بندی، طول هر بازه، $t_i = \frac{1.2l_i}{m}$ می‌شود و مجموعه سر بازه‌ها برابر
 $$R_i = \{ j \times t_i \ | 1 \leq j \leq m \}$$
 می‌گردد. طبق توضیحات قسمت قبل، سر یکی از بازه‌ها کاندیدای مناسبی برای $r'$ است. 
 
 حال کافی است که در هر لحظه $m$ نمونه از الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} را به ازای هر $r \in R_i$ به صورت موازی اجرا نماییم. به ازای اضافه شدن نقطه‌ی $p_i$، اگر $l_i = l_{i-1}$ باشد، $R_i = R_{i-1}$ است و در نتیجه بدون هیچ تغییری کافی است $p_i$ را به تمام نمونه‌های موازی اضافه کنیم. در حالتی که $l_{i-1} < l_{i}$ باشد، مجموعه‌ی $R_i$ را می‌توان به دو زیرمجموعه تقسیم نمود. اعضایی از $r \in R_i$ که کم‌تر مساوی $1.2l_{i-1}$ هستند و در نتیجه داخل $R_{i-1}$ نیز قرار دارند (چون $\frac{t_i}{t_{i-1}}$ همواره توان صحیحی از دو است). برای چنین اعضایی، کافی است، نمونه معادل‌ آن را در $R_{i-1}$ بدون هیچ تغییری پیدا کرد و نقطه‌ی $p_i$ را به آن اضافه کرد. اگر $r \in R_i$ باشد و در $R_{i-1}$ نباشد، در نتیجه $l_{i-1} \leq 1.2l_{i-1} \leq r$ است. با توجه با نحوه‌ی عمل‌کرد الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}، می‌دانیم در هر لحظه $z$ نقطه‌ای به عنوان داده‌ی پرت در نظر گرفته می‌شود که فاصله‌ی بزرگ‌تر مساوی $l_i$ دارند و بقیه نقاطی که تا کنون آمده‌اند فاصله‌ای کم‌تر مساوی $l_i$ دارند. بنابراین در بین تمام نقاط جویبار داده تا کنون، حداکثر $z$ نقطه‌ی ذخیره شده در حافظه‌ی میان‌گیر الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} خارج توپ $B(p_1, r)$ می‌افتند. بنابراین اگر بخواهیم به ازای این $r$ جدید الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} را برروی نقاط جویبارداده تاکنون اجرا نماییم، کافی است الگوریتم را به ازای نقاط داخل حافظه‌ی میان‌گیر اجرا نموده و مطمئن هستیم که بقیه‌ی نقاط به علت قرار گیری داخل $B(p_1, r)$، تاثیری در روند اجرای الگوریتم نخواهند داشت. 
 
 با جمع‌بندی روند توضیح داده شده، ساخت یک نمونه‌ی جدید از الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} معادل اضافه کردن حداکثر $z$ نقطه‌ی موجود در حافظه‌ی میان‌گیر الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $2$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} به نمونه‌ی جدید از الگوریتم  که از مرتبه‌ی $\cO(zd)$ زمان می‌برد. در هر مرحله هم حداکثر $m$ نمونه‌ی جدید ساخته می‌شود، بنابراین زمان به‌روزرسانی نمونه‌ها در هر مرحله حداکثر $\cO(\frac{zd}{\epsilon})$ است. از طرفی در هر لحظه $mz$($z$ به خاطر عدم اطمینان از نقطه‌ی دومی که داخل $B^*$ قرار می‌گیرد و $m$ به علت عدم اطمینان از محل قرارگیری $r'$ در بازه‌ها) نمونه موازی از‌ الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} در حال اجراست. بنابراین، زمان به‌روزرسانی نهایی الگوریتم برابر $\cO(\frac{z^2d}{\epsilon})$ است و حافظه‌ی مصرفی نیز متناسب با $mz$ نمونه‌ی موازی از الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} برابر $\cO(\frac{zd}{\epsilon})$ است. با دخیل کردن امکان پرت نبودن نقطه‌ی اول جویبار داده، به قضیه‌ی زیر می‌رسیم:
 
 \شروع{قضیه}
 الگوریتم ~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت} با مصرف حافظه‌ی $\cO(\frac{z^2d}{\epsilon})$ و زمان به‌روزرسانی $\cO(\frac{z^3d}{\epsilon})$، در هر لحظه با صرف زمان اجرای $\cO(\frac{z^2}{\epsilon})$ جوابی با ضریب تقریب $1.8 + \epsilon$ ارائه می‌دهد.
 \پایان{قضیه}


\شروع{شکل}
\centering
\begin{tikzpicture}
  [scale=.75,auto=left,every node/.style={circle,fill=blue!15}]
 \tikzset{edge/.style = {->,> = latex'}}
  \node (1) at (1,1) {شروع};
  \node (2) at (5,1)  {\rl{توپ اولیه}};
  \node (3) at (10,1)  {\rl{توپ گسترش‌یافته}};
  \node (e) at (15,1)  {پایان};

  \foreach \from/\to/\label in {1/2/0,2/3/1,3/e/2} 
    \draw[edge] (\from) edge node[midway, fill=white]{$z_\label$} (\to);

\end{tikzpicture}
\شرح{نحوه‌ی اجرای الگوریتم~\رجوع{الگوریتم: الگوریتم با ضریب تقریب $1.8$ برای مسئله‌ی $1$-مرکز با $z$ داده‌ی پرت}}
\برچسب{شکل:گراف‌ بدون جهت برای مسئله‌ی $1$-مرکز با ضریب تقریب $1.8$}
\پایان{شکل}
 
اگر بخواهیم الگوریتم گفته شده را جمع‌بندی کنیم، الگوریتم همان‌طور که در شکل ~\رجوع{شکل:گراف‌ بدون جهت برای مسئله‌ی $1$-مرکز با ضریب تقریب $1.8$} نشان‌داده شده است. در ابتدا $z_0$ نقطه‌ی اول را به عنوان داده‌ی پرت در نظر می‌گیرد و سپس $z_0 + 1$اُمین نقطه‌ی جویبار داده را به عنوان نقطه‌ی اول و مرکز‌ توپ $B$ به شعاع $r'$ در نظر می‌گیرد. سپس $z_1$ نقطه‌ی اولی از ادامه‌ی جویبارداده که بیرون این توپ قرار می‌گیرند را به عنوان داده‌ی پرت در نظر گرفته و به ازای $z_1+1$اُمین نقطه‌ی خارج $B$، آن را در همان راستا گسترش می‌دهد. سپس $z_2$ نقطه‌ی دیگر از ادامه‌ی جویبارداده که خارج $B-$گسترش‌یافته قرار می‌گیرند را نیز‌به عنوان داده‌ی پرت در نظر می‌گیرد، حال اگر نقطه‌ی دیگری در جویبارداده وجود داشته باشد که خارج $B$ بیفتد با توجه به اینکه $\sum_{i = 0}^{2} z_i = z$ است، تعداد نقاط پرت از‌ $z$ بیش‌تر شده و نشان می‌دهد یکی از فرض‌های اولیه اشتباه بوده و در نتیجه، گزینه حذف می‌گردد.

\زیرقسمت{مسئله‌ی $1$-مرکز‌ پوشاننده در حالت جویبار داده}

در این زیر قسمت به بررسی مسئله‌ی تقریبا جدیدی می‌پردازیم. در ابتدا به تعریف دقیق مسئله می‌پردازیم:

\شروع{تعریف}

\پایان{تعریف}

\زیرقسمت{مسئله‌ی $1$-مرکز با داده‌های پرت در حالت جویبار داده با تعداد داده‌های پرت ثابت}

\قسمت{مسئله‌ی $2$-مرکز با داده‌های پرت در حالت جویبار داده}

\زیرقسمت{حالت $\delta^* \leq \alpha r^*$}

\زیرزیرقسمت{الگوریتم اصلی}

\زیرزیرقسمت{پیدا کردن $r'$}

\زیرقسمت{حالت $\delta^* \geq \alpha r^*$}

\زیرزیرقسمت{الگوریتم اصلی}

\زیرزیرقسمت{پاسخ‌گویی به پرسمان‌ها}

